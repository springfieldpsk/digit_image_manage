# 图像变换

## 目的

1. 使图像处理问题简化
2. 有利于图像特征提取
3. 有助于从概念上增强对图像信息的理解

## 要求

图像变换通常是一种二维正交变换，要求

1. 正交变换必须是可逆的
2. 正变换和反变换的算法不能太复杂
3. 正交变换的特点是在变换域中图像能量将集中分布在低频率成分上，边缘、线状信息反映在高频率成分上，有利于图像处理

正交变换广泛应用在图像增强、图像恢复、特征提取、图像压缩编码和形状分析等方面

## 傅里叶变换

傅里叶原理表明：任何连续测量的时序或者信号，都可以表示为不同频率的正弦波信号的无限叠加

傅里叶变换将原来难以处理的时域信号转换成易于分析的频域信号，在对频域信号处理、加工后，通过傅里叶反变换将这些频域信号转换成时域信号

图像的频率是表征图像中灰度变换剧烈程度的指标，是灰度在平面空间上的梯度。

从物理效果看，傅里叶变换就是将图像从空间域转换到频率域，其逆变换是将图像从频率域转换到空间域，即傅里叶变换是将图像灰度函数变换为图像的频率分布函数，逆变换是将图像的频率分布函数变换为图像灰度函数

通过观察傅里叶变换后的频谱图，也称功率图，了解图像特征，图像能量集中在低频区域，陡变信息及噪声分布在高频区域

## 频域图像增强

### 频域

正弦波是一个圆周运动在一条直线上的投影，所以频域的基本单元也可以理解为一个始终在旋转的圆

### 点源和狄拉克函数

点源的概念：一幅图像可看作由无穷个像素组成，每个像素可看作一个点源成像，即一幅图像由无穷个点源组成

点源可用狄拉克函数$\delta$函数来表示

$$
\delta(x,y) =
\left\{\begin{matrix}
\infty & x=0,y=0\\ 
0 & 其他
\end{matrix}\right.
$$

且满足
$$
\iint_{-\infty}^{\infty} \delta(x,y) dxdy = \iint_{-\varepsilon} ^{\varepsilon} \delta(x,y) dxdy =1
$$

当输入为单位脉冲 $\delta(x,y)$时,系统的输出便称为脉冲响应，用$h(x,y)$表示。在图像处理中，它便是对点源的响应，称为点扩散函数

扩散函数：目标中出现一个点，它在成像时对输出图像产生影响

当输入的单位脉冲延迟了$\alpha、\beta$单位，即输入为$\delta(x-\alpha,y-\beta)$时，若输出为$h(x-\alpha,y-\beta)$,则成该系统为位移不变系统

位移不变系统：成像系统在各个位置具有稳定性和一致性不因目标物位置变化而产生输出结果亮度变化的现象，所有的成像系统都是位移不变系统

对于一个位移不变系统，若输入为$f(x,y)$,输出为$g(x,y)$,则$g(x,y)=f(x,y)*h(x,y)$

上式表明线性位移不变系统的输出等于系统的输入和系统脉冲响应（点扩散函数）的卷积

### 傅里叶变换

任何周期函数都可以表达为不同频率的正弦或余弦和的形式即傅里叶级数

傅里叶级数表明了信号由哪些频率分量组成及其所占比重，从而有利于对信号进行分析与处理

#### 连续函数的傅里叶变换

令$f(x)$ 为实变量x的连续函数,$f(x)$的傅里叶变换可用$F(u)$表示

一维连续函数的傅里叶变换对
$$
F(u) =
\int _{-\infty}^{\infty} f(x)e^{-j2\pi ux} dx
$$
$$
f(x)= \int_{-\infty}^{\infty} F(u) e^{j2\pi ux} dx
$$

傅里叶变换中出现的变量（能量）u通常称为频率变量

二维连续函数的傅里叶变换对

$$
F(u,v) =
\iint _{-\infty}^{\infty} f(x,y)e^{-j2\pi (ux+vy)} dxdy
$$
$$
f(x,y)= \iint_{-\infty}^{\infty} F(u,v)e^{j2\pi (ux+vy)} dudv
$$

#### 离散函数的傅里叶变换

**一维离散函数的傅里叶变换定义式为**

$$
F(u)=\frac{1}{N} \sum _{x=0} ^{N-1} f(x) e ^{-j2\pi ux / N}
$$
$$
u= 0,1,2,...,N-1
$$

反变换为

$$
f(x)=\sum _{u=0} ^{N-1} F(u) e ^{j2\pi ux / N}
$$
$$
x= 0,1,2,...,N-1
$$

傅里叶变换将信号分成不同频率成分，故称为数学棱镜

傅里叶变换的成分：直流分量和交流分量

二维离散函数的傅里叶变换定义式为

$$
F(u,v)=\frac{1}{MN} \sum _{x=0} ^{M-1} \sum_{y=0} ^{N-1} f(x,y) e ^{-j2\pi (ux / M+vy/N)}
$$
$$
u= 0,1,2,...,M-1,v= 0 ,1,2,...,N-1
$$

反变换为

$$
f(x,y)=\sum _{u=0} ^{M-1} \sum_{v=0} ^{N-1} F(u,v) e ^{j2\pi  (ux / M+vy/N)}
$$
$$
u= 0,1,2,...,M-1,v= 0 ,1,2,...,N-1
$$

提高傅里叶变换速度：

1. 快速傅里叶变换(FFT)
2. 硬件加速

#### 二维离散函数的傅里叶变换的性质

1. 周期和共轭对称性
   $$
   F(u,v)=F(u+N,v)=F(u,v+N)=F(u+N,v+N)
   $$
   $$
   F(u,v) = F^{*}(-u,-v)
   $$
2. 分离性
   一个二维傅里叶变换可有连续两次一维傅里叶变换实现
3. 平移性
4. 旋转性质
   如果$f(x,y)$被旋转$\theta_0$,则$F(u.v)$被旋转同一角度
   $$
   f(r,\theta+\theta_0) \Leftrightarrow F(\omega,\varphi+\theta_0)
   $$

## 图像的频率域增强

图像增强的目的主要包括：

1. 消除噪声
2. 突出边缘

频率域增强的一般过程

$$
f(x,y) \xrightarrow[]{DFT} F(u,v) \xrightarrow[滤波]{H(u,v)} F(u,v)H(u,v) \xrightarrow{IDFT} g(x,y)
$$

$$
原图像f(x,y) , 滤波器 H(u,v) ,增强图像g(x,y)
$$

### 频率域平滑

采用低通滤波器$H(u,v)$来抑制高频成分，通过低频成分，以达到平滑图像的目的

常用的频率域低通滤波器有四种

#### 理想低通滤波器

设傅里叶平面上理想低通滤波器离开原点的截止频率为$D_0$,则理想低通滤波器的传递参数为

$$
H(u,v)=
\left\{\begin{matrix}
1 & D(u,v) \leq D_0 \\
0 & D(u,v) > D_0
\end{matrix}\right.
$$

使用该滤波器去除噪声会导致边缘信息损失而使图像边模糊，并产生振铃效应

#### Butterworth 低通滤波器

n阶Butterworth 滤波器的传递函数为

$$
H(u,v) = \frac{1} {1 + [\frac{D(u,v)}{D_0}]^{2n}}
$$

特性是连续性衰减，使用该滤波器滤波在抑制噪声时，图像边缘模糊程度减少，没有振铃效应产生

#### 指数低通滤波器

传递参数为

$$
H(u,v) = e ^ {[-\frac{D(u,v)}{D_0}]^n}
$$

使用该滤波器滤波在抑制噪声时，较Butterworth低通滤波器图像边缘模糊程度较大，无明显的振铃效应产生

#### 梯形低通滤波器

梯形低通滤波器是理想低通滤波器与完全平滑滤波器的折中，传递参数为

$$
H(u,v)=
\left\{\begin{matrix}
1 & D(u,v) < D_0 \\
\frac{D(u,v)-D_1}{D_0-D_1} & D_0 \leq D(u,v) \leq D_1\\
0 & D(u,v) > D_1
\end{matrix}\right.
$$

性能介于理想低通与指数滤波器之间，有一定的模糊和振铃效应

### 频率域锐化

频率域锐化是为了消除模糊，突出边缘，采用高通滤波器让高频成分通过，低频成分削弱

常用的高通滤波器有

#### 理想高通滤波器

理想高通滤波器的传递参数为

$$
H(u,v)=
\left\{\begin{matrix}
0 & D(u,v) \leq D_0 \\
1 & D(u,v) > D_0
\end{matrix}\right.
$$

有明显振铃现象，即图像边缘有抖动现象

#### Butterworth 高通通滤波器

n阶Butterworth 滤波器的传递函数为

$$
H(u,v) = \frac{1} {1 + [\frac{D_0}{D(u,v)}]^{2n}}
$$

效果较好，但是计算复杂，有少量低频通过，$H(u,v)$是渐变的，振铃现象不明显

#### 指数高通滤波器

传递参数为

$$
H(u,v) = e ^ {-[\frac{D_0}{D(u,v)}]^n}
$$

效果较Butterworth差，振铃现象不明显

#### 梯形高通滤波器

传递参数为

$$
H(u,v)=
\left\{\begin{matrix}
0 & D(u,v) < D_0 \\
\frac{D(u,v)-D_1}{D_0-D_1} & D_0 \leq D(u,v) \leq D_1\\
1 & D(u,v) > D_1
\end{matrix}\right.
$$

计算简单，会产生微振铃效果

高频滤波在增强细节的同时，也会增强噪声，因此不能随意使用

### 同态滤波增强

原理：将像元灰度值视为照度和反射率相互作用下的产物。由于照度相对变化小，可以视为低频成分，反射率视为高频成分，通过分别处理照度和反射率对像元灰度值的影响，从而达到揭示阴影区细节特征的目的

同态滤波基于
$$
f(x,y)= i(x,y)r(x,y)
$$

入射光对应图像中的低频部分，反射光对应图像中的高频部分

流程

$$
f(x,y) \rightarrow ln \rightarrow FFT \rightarrow H(u,v) \rightarrow IFT \rightarrow exp \rightarrow g(x,y)
$$

同态滤波是一种在频域中同时将图像的亮度范围进行压缩和对比度增强的频域方法

同态滤波的最终结果是同时将图像的动态范围压缩又使图像各部分之间的对比度增强